!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ZkFormBuilder=t():e.ZkFormBuilder=t()}(this,(()=>(()=>{"use strict";var e={d:(t,i)=>{for(var r in i)e.o(i,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t,i){return(t=v(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t,r){return t=s(t),function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,a()?Reflect.construct(t,r||[],s(e).constructor):t.apply(e,r))}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(a=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function f(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return c(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return l=e.done,e},e:function(e){a=!0,o=e},f:function(){try{l||null==i.return||i.return()}finally{if(a)throw o}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function m(e,t,i){return t&&p(e.prototype,t),i&&p(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}e.d(t,{default:()=>M});var b=function(){return m((function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.error=t||null,this.formBuilder=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.error||this.error.errors){var e,t=this.formBuilder.createWrapperElement(this.error.wrapper||[],this.context),i=f(this.error.errors);try{for(i.s();!(e=i.n()).done;){var r=e.value,n=document.createElement(this.error.tag||"span");for(var o in this.error.attributes){var l=this.error.attributes[o];n.setAttribute(isNaN(o)?o:l,!isNaN(o)||l)}n.appendChild(this.formBuilder.stringToHTML(this.error.before||"")),n.appendChild(this.formBuilder.stringToHTML(r)),n.appendChild(this.formBuilder.stringToHTML(this.error.after||"")),t.appendChild(n)}}catch(e){i.e(e)}finally{i.f()}}}},{key:"position",value:function(){var e;return(null===(e=this.error)||void 0===e?void 0:e.position)||"after-input"}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"after-input";return this.error&&this.position()===e?this.context:""}}])}(),y=function(){return m((function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.label=t||null,this.formBuilder=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.label){var e=this.formBuilder.createWrapperElement(this.label.wrapper||[],this.context),t=document.createElement(this.label.tag);for(var i in this.label.attributes){var r=this.label.attributes[i];t.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}t.appendChild(this.formBuilder.stringToHTML(this.label.before||"")),t.appendChild(document.createTextNode(this.label.text)),t.appendChild(this.formBuilder.stringToHTML(this.label.after||"")),e.appendChild(t)}}},{key:"position",value:function(){var e;return(null===(e=this.label)||void 0===e?void 0:e.position)||"before-input"}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"before-input";return this.label&&this.position()===e?this.context:""}}])}(),g=function(){return m((function e(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.field=t||null,this.viewOnly=(null===(i=this.field)||void 0===i?void 0:i.viewOnly)||!1,this.formBuilder=r,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.field){var e=this.formBuilder.createElementInstance(this.field.label,this),t=this.formBuilder.createElementInstance(this.field.error,this),i=this.viewOnly||"multiple"!==this.field.type?null:this.formBuilder.createElementInstance(this.field.addAction,this);this.formBuilder.renderElementInPosition(this.context,e,"before-wrapper"),this.formBuilder.renderElementInPosition(this.context,t,"before-wrapper"),this.formBuilder.renderElementInPosition(this.context,i,"before-wrapper");var r=this.formBuilder.createWrapperElement(this.field.wrapper||[],this.context);this.formBuilder.renderElementInPosition(r,e,"before-input"),this.formBuilder.renderElementInPosition(r,t,"before-input"),this.formBuilder.renderElementInPosition(r,i,"before"),this.buildField(r),this.formBuilder.renderElementInPosition(r,i,"after"),this.formBuilder.renderElementInPosition(r,t,"after-input"),this.formBuilder.renderElementInPosition(r,e,"after-input"),this.formBuilder.renderElementInPosition(this.context,i,"after-wrapper"),this.formBuilder.renderElementInPosition(this.context,e,"after-wrapper"),this.formBuilder.renderElementInPosition(this.context,t,"after-wrapper")}}},{key:"buildField",value:function(e){var t=this.formBuilder.createWrapperElement(this.field.inputWrapper||[],e);t.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var i="";if(this.viewOnly&&this.field.view)i=this.formBuilder.stringToHTML(this.field.view);else if(this.viewOnly&&!["checkbox","radio"].includes(this.field.type))if((i=document.createElement("div")).setAttribute("data-view-only","true"),"file"===this.field.type){i.setAttribute("class","frm-view-only type-".concat(this.field.type));var r=document.createElement("ul");r.setAttribute("class","file-list list-unstyled");var n,o=f(this.field.files);try{for(o.s();!(n=o.n()).done;){var l=n.value,a=document.createElement("li");a.setAttribute("class","file-item");var s=document.createElement("a");s.setAttribute("href",l),s.setAttribute("target","_blank");var u=l.split("/").pop();s.append(u),a.append(s),r.appendChild(a)}}catch(e){o.e(e)}finally{o.f()}i.append(r)}else i.setAttribute("class","form-control frm-view-only type-".concat(this.field.type)),i.append(this.field.value);else i=document.createElement("textarea"===this.field.type?"textarea":"input"),this.setElementAttributes(i),this.viewOnly&&["checkbox","radio"].includes(this.field.type)&&(i.setAttribute("readonly","readonly"),i.setAttribute("disabled","disabled"),i.setAttribute("data-view-only","true"));t.appendChild(i),t.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}},{key:"setElementAttributes",value:function(e){for(var t in"textarea"!==this.field.type&&e.setAttribute("type",this.field.type),this.field.attributes){var i=this.field.attributes[t];e.setAttribute(isNaN(t)?t:i,!isNaN(t)||i)}this.field.rules&&e.setAttribute("data-rules",JSON.stringify(this.field.rules)),this.field.messages&&e.setAttribute("data-messages",JSON.stringify(this.field.messages)),null!==this.field.value&&("textarea"===this.field.type?e.innerHTML=this.field.value:"file"!==this.field.type&&e.setAttribute("value",this.field.value))}},{key:"render",value:function(){return this.context}}])}(),E=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,i])}return u(t,e),m(t)}(g),O=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,i])}return u(t,e),m(t)}(g),k=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,i])}return u(t,e),m(t)}(g),w=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,i])}return u(t,e),m(t,[{key:"buildField",value:function(e){var t=this.formBuilder.createWrapperElement(this.field.inputWrapper||[],e);t.appendChild(this.formBuilder.stringToHTML(this.field.before||"")),this.viewOnly?this.createViewOnlyElement(t):this.createSelectElement(t),t.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}},{key:"createViewOnlyElement",value:function(e){if(this.field.view){var t=this.formBuilder.stringToHTML(this.field.view);e.appendChild(t)}else{var i=document.createElement("div");i.setAttribute("class","frm-view-only type-".concat(this.field.type)),i.setAttribute("data-view-only","true");var r=document.createElement("ul");if(r.setAttribute("class","list-unstyled"),this.field.options){var n,o=f(this.field.options);try{for(o.s();!(n=o.n()).done;){var l=n.value;if(l.optgroup){var a,s=f(l.options);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.selected){var d=document.createElement("li");d.append(u.label),r.appendChild(d)}}}catch(e){s.e(e)}finally{s.f()}}else if(l.selected){var c=document.createElement("li");c.append(l.label),r.appendChild(c)}}}catch(e){o.e(e)}finally{o.f()}}i.append(r),e.appendChild(i)}}},{key:"createSelectElement",value:function(e){var t=document.createElement("select");for(var i in this.field.attributes){var r=this.field.attributes[i];t.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}if(this.field.rules&&t.setAttribute("data-rules",JSON.stringify(this.field.rules)),this.field.messages&&t.setAttribute("data-messages",JSON.stringify(this.field.messages)),this.field.options){var n,o=f(this.field.options);try{for(o.s();!(n=o.n()).done;){var l=n.value;if(l.optgroup){var a=this.createOptGroupElement(l);t.appendChild(a)}else{var s=this.createOptionElement(l);t.appendChild(s)}}}catch(e){o.e(e)}finally{o.f()}}e.appendChild(t)}},{key:"isMultiselect",value:function(){return this.field.multiselect}},{key:"optionAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i={};for(var r in e)t.includes(r)||(i[r]=e[r]);return i}},{key:"isSelected",value:function(e){return null!==e&&null!==this.field.value&&(this.isMultiselect()&&this.field.value.includes(e)||!this.isMultiselect()&&this.field.value==e)}},{key:"createOptGroupElement",value:function(e){var t=document.createElement("optgroup");t.label=e.label;var i=this.optionAttributes(e,["label","optgroup","options"]);for(var r in i){var n=i[r];t.setAttribute(isNaN(r)?r:n,!isNaN(r)||n)}var o,l=f(e.options);try{for(l.s();!(o=l.n()).done;){var a=o.value,s=this.createOptionElement(a);t.appendChild(s)}}catch(e){l.e(e)}finally{l.f()}return t}},{key:"createOptionElement",value:function(e){var t=document.createElement("option");t.value=e.value,t.text=e.label;var i=this.optionAttributes(e,["label","value"]);for(var r in i){var n=i[r];t.setAttribute(isNaN(r)?r:n,!isNaN(r)||n)}return t}}])}(g),B=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,i])}return u(t,e),m(t,[{key:"buildField",value:function(e){e.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var t,i=this.formBuilder.createWrapperElement(this.field.itemWrapper||[],e),r=f(this.field.items);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=this.formBuilder.createElementInstance(n).render();o&&i.appendChild(o)}}catch(e){r.e(e)}finally{r.f()}e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}}])}(g),j=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,i])}return u(t,e),m(t,[{key:"buildField",value:function(e){e.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var t,i=this.formBuilder.createWrapperElement(this.field.fieldWrapper||[],e),r=f(this.field.fields);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=this.formBuilder.createElementInstance(n).render();o&&i.appendChild(o)}}catch(e){r.e(e)}finally{r.f()}e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}}])}(g),T=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,i])}return u(t,e),m(t,[{key:"buildField",value:function(e){e.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var t,i=this.formBuilder.createWrapperElement(this.field.contentWrapper||[],e),r=f(this.field.rows||[]);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.buildRow(i,n)}}catch(e){r.e(e)}finally{r.f()}e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}},{key:"buildRow",value:function(e,t){var i=this.viewOnly?null:this.formBuilder.createElementInstance(t.removeAction),r=this.formBuilder.createWrapperElement(t.wrapper.wrapper||[],e);this.formBuilder.renderElementInPosition(r,i,"before");var n,o=t.wrapper.fieldWrapper||[],l=this.formBuilder.createWrapperElement(o.wrapper||[],r),a=f(t.fields);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=this.formBuilder.createElementInstance(s).render();u&&l.appendChild(u)}}catch(e){a.e(e)}finally{a.f()}return this.formBuilder.renderElementInPosition(r,i,"after"),r}}])}(g),A=function(){return m((function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;h(this,e),this.action=t||null,this.formBuilder=i,this.parent=r,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.action&&this.action.show){var e=this.formBuilder.createWrapperElement(this.action.wrapper||[],this.context),t=document.createElement(this.action.tag);for(var i in this.action.attributes){var r=this.action.attributes[i];t.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}this.action.rowObject&&t.setAttribute("data-row-object",JSON.stringify(this.action.rowObject)),t.appendChild(this.formBuilder.stringToHTML(this.action.label||"")),e.appendChild(t)}}},{key:"position",value:function(){var e;return(null===(e=this.action)||void 0===e?void 0:e.position)||"before"}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"before";return this.action&&this.position()===e?this.context:""}}])}(),C=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,i])}return u(t,e),m(t,[{key:"buildField",value:function(e){e.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var t,i=this.formBuilder.createWrapperElement(this.field.tabWrapper||[],e),r=f(this.field.tabs);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.formBuilder.createWrapperElement(n.itemWrapper.wrapper||[],i).appendChild(this.formBuilder.stringToHTML(n.label))}}catch(e){r.e(e)}finally{r.f()}var o,l=this.formBuilder.createWrapperElement(this.field.contentWrapper||[],e),a=f(this.field.tabs);try{for(a.s();!(o=a.n()).done;){var s,u=o.value,d=this.formBuilder.createWrapperElement(u.panelWrapper.wrapper||[],l),c=f(u.fields);try{for(c.s();!(s=c.n()).done;){var h=s.value,p=this.formBuilder.createElementInstance(h).render();p&&d.appendChild(p)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){a.e(e)}finally{a.f()}e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}}])}(g),x=function(){return m((function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.buttons=t||null,this.formBuilder=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.buttons){var e=this.formBuilder.createWrapperElement(this.buttons.wrapper||[],this.context);this.buildActions(e)}}},{key:"buildActions",value:function(e){var t,i=f(this.buttons.actions);try{for(i.s();!(t=i.n()).done;){var r=t.value,n=this.formBuilder.createButtonInstance(r).render();n&&e.appendChild(n)}}catch(e){i.e(e)}finally{i.f()}}},{key:"position",value:function(){var e;return null!==(e=this.buttons)&&void 0!==e&&e.position?this.buttons.position:"form-bottom"}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form-bottom";return this.buttons&&this.position()===e?this.context:""}}])}(),N=function(){return m((function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.action=t,this.formBuilder=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.action){var e=this.formBuilder.createWrapperElement(this.action.wrapper||[],this.context),t=document.createElement(this.action.tag);for(var i in this.action.attributes){var r=this.action.attributes[i];t.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}t.appendChild(this.formBuilder.stringToHTML(this.action.before||"")),t.appendChild(this.formBuilder.stringToHTML(this.action.text)),t.appendChild(this.formBuilder.stringToHTML(this.action.after||"")),e.appendChild(t)}}},{key:"render",value:function(){return this.context}}])}(),M=function(){function e(){var t,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h(this,e),o(this,"form",null),o(this,"validator",null),o(this,"frmObj",null),o(this,"frmContainer",null),o(this,"context",null),o(this,"options",{multiple:{addButton:'[data-action="add-row"]',removeButton:'[data-action="remove-row"]'},loading:'<div class="text-center m-4">Loading...</div>'}),o(this,"subscribers",{}),o(this,"subscribersData",{}),this.setOptions(r),this.setValidatorObj("undefined"!=typeof ZkFormValidator&&ZkFormValidator||(null===(t=window)||void 0===t?void 0:t.ZkFormValidator)||(null===(i=window)||void 0===i||null===(i=i.ZkValidator)||void 0===i?void 0:i.ZkFormValidator)||null),this.context=document.createDocumentFragment()}return m(e,[{key:"setOptions",value:function(e){this.options=n(n({},this.options),e)}},{key:"getOptions",value:function(){return this.options}},{key:"getForm",value:function(){return this.form}},{key:"setForm",value:function(e){null==(e="string"==typeof e?document.getElementById(e):e)||e&&"FORM"!==e.tagName?console.error("Form not found"):(this.form=e,this.initMultiple(),!this.validator&&this.validatorObj&&(this.validator=new this.validatorObj(this.form)))}},{key:"setValidatorObj",value:function(e){this.validatorObj=e}},{key:"getValidatorObj",value:function(){return this.validatorObj}},{key:"setValidator",value:function(e){this.validator=e}},{key:"getValidator",value:function(){return this.validator}},{key:"validate",value:function(){return!this.validator||this.validator.validate()}},{key:"setFormObject",value:function(e){this.frmObj="string"==typeof e?JSON.parse(e):e}},{key:"render",value:function(e,t){if(this.frmContainer=document.getElementById(e)||document.querySelector(e),!this.frmContainer)return this.dispatch("beforeRender",{status:"error",message:"Container not found"}),void console.error("Container not found");this.generate(t)}},{key:"generate",value:function(e){e&&this.setFormObject(e),this.dispatch("beforeRender",{status:"success",container:this.frmContainer,frmObj:this.frmObj}),this.frmContainer.innerHTML="",this.frmContainer.appendChild(this.stringToHTML(this.options.loading)),this.buildForm(),this.frmContainer.innerHTML="",this.frmContainer.appendChild(this.context),this.validatorObj&&(this.validator=new this.validatorObj(this.form)),this.initMultiple(),this.dispatch("afterRender",{status:"success",container:this.frmContainer}),this.frmObj=null}},{key:"buildForm",value:function(){var e;if(!this.frmObj)return this.dispatch("beforeBuildForm",{status:"error",message:"Form object not found"}),void console.error("Form object not found");this.context=document.createDocumentFragment();var t=this.createWrapperElement((null===(e=this.frmObj)||void 0===e?void 0:e.wrapper)||[],this.context);for(var i in t.appendChild(this.stringToHTML(this.frmObj.beforeRender||"")),this.form=document.createElement("form"),this.dispatch("beforeBuildForm",{status:"success",form:this.form}),this.form.appendChild(this.stringToHTML(this.frmObj.before||"")),this.frmObj.action&&this.form.setAttribute("action",this.frmObj.action),this.form.setAttribute("method","GET"===this.frmObj.method?"GET":"POST"),this.frmObj.attributes){var r=this.frmObj.attributes[i];this.form.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}this.addHiddenFields();var n=this.createElementInstance(this.frmObj.buttons,this);this.renderElementInPosition(this.form,n,"form-top"),this.buildField(this.frmObj.fields),this.renderElementInPosition(this.form,n,"form-bottom"),this.form.appendChild(this.stringToHTML(this.frmObj.after||"")),t.appendChild(this.form),t.appendChild(this.stringToHTML(this.frmObj.afterRender||"")),this.dispatch("afterBuildForm",{status:"success",form:this.form})}},{key:"buildField",value:function(e){if(Array.isArray(e)){var t,i=f(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this.buildField(r)}}catch(e){i.e(e)}finally{i.f()}}else{var n=this.createElementInstance(e);this.renderElement(this.form,n)}}},{key:"createElementInstance",value:function(t){if(!t||null==t||!t.jsElement)return null;var i=this[t.jsElement]||e[t.jsElement]||null;if(!i)return console.error("".concat(t.jsElement," class not found")),null;for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return function(e,t,i){if(a())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var n=new(e.bind.apply(e,r));return i&&d(n,i.prototype),n}(i,[t,this].concat(n))}},{key:"createButtonInstance",value:function(t){if(!t||null==t||!t.jsElement)return null;var i=this[t.jsElement]||e[t.jsElement];return i?new i(t,this):(console.error("".concat(t.jsElement," class not found")),null)}},{key:"renderElement",value:function(e,t){if(t){var i=t.render();i&&e.appendChild(i)}}},{key:"renderElementInPosition",value:function(e,t,i){if(t){var r=t.render(i);r&&e.appendChild(r)}}},{key:"createWrapperElement",value:function(e,t){var i,r=t,n=f(e);try{for(n.s();!(i=n.n()).done;){var o=i.value;o.before&&r.appendChild(this.stringToHTML(o.before));var l=document.createElement(o.tag);this.setAttributesFromString(l,o.attributes),r.appendChild(l),o.after&&r.appendChild(this.stringToHTML(o.after)),r=l}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"stringToHTML",value:function(e){if(!e)return document.createDocumentFragment();var t=document.createElement("template");return t.innerHTML=(""+e).trim(),t.content}},{key:"setAttributesFromString",value:function(e,t){if(t){var i,r=f(t.matchAll(/([a-zA-Z0-9-]+)(?:=["']([^"']*)["'])?/g));try{for(r.s();!(i=r.n()).done;){var n=i.value;e.setAttribute(n[1],n[2]||!0)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"addMoreEvent",value:function(e){var t,i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||e.getAttribute("data-add-prefix"),l=r||e.getAttribute("data-row-object");"string"==typeof l&&(l=JSON.parse(l));var a=n||(null===(t=l)||void 0===t?void 0:t.jsElement)||e.getAttribute("data-js-element");if(a&&o&&l){var s=this.form.querySelector('[data-prefix="'.concat(o,'"]'));if(s){var u=this.debounce((function(e){e.preventDefault();var t=i.createElementInstance({jsElement:a});if(t){var r=l.name,n=l.rowPrefix||i.toBracketNotation(r),u=i.generateRandomString(),d=(new Date).getTime(),f=JSON.stringify(l);f=(f=(f=f.replaceAll(r,r.replaceAll("{{index}}","{{".concat(u,"}}")))).replaceAll(n,n.replaceAll("{{index}}","{{".concat(u,"}}")))).replaceAll("{{".concat(u,"}}"),d);var c=t.buildRow(document.createDocumentFragment(),JSON.parse(f));s.appendChild(c),c.querySelectorAll(i.options.multiple.addButton).forEach((function(e){i.addMoreEvent(e)})),c.querySelectorAll(i.options.multiple.removeButton).forEach((function(e){i.addRemoveEvent(e)})),i.validator&&i.validator.addContextFields&&i.validator.addContextFields(c),i.dispatch("addRow",{_container:o,context:c,rowName:r,rowPrefix:n,uniqueId:u,timeStr:d})}}),150);e.removeEventListener("click",u),e.addEventListener("click",u)}}}},{key:"addRemoveEvent",value:function(e){var t=this,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||e.getAttribute("data-remove-prefix");if(i){var r=this.debounce((function(e){e.preventDefault();var r=t.form.querySelector('[data-row-prefix="'.concat(i,'"]'));r&&(t.validator.removeContextFields(r),t.dispatch("removeRow",{_container:i,context:r}),r.remove())}),100);e.removeEventListener("click",r),e.addEventListener("click",r)}}},{key:"initMultiple",value:function(){var e=this;this.form.querySelectorAll(this.options.multiple.addButton).forEach((function(t){e.addMoreEvent(t)})),this.form.querySelectorAll(this.options.multiple.removeButton).forEach((function(t){e.addRemoveEvent(t)}))}},{key:"addHiddenFields",value:function(){this.frmObj.csrf&&this.addHiddenField("_token",this.frmObj.csrf_token),this.frmObj.frmKey&&this.addHiddenField("_form",this.frmObj.frmKey),["GET","POST"].includes(this.frmObj.method)||this.addHiddenField("_method",this.frmObj.method)}},{key:"addHiddenField",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.createElement("input");for(var n in r.setAttribute("type","hidden"),r.setAttribute("name",e),r.setAttribute("value",t),i){var o=this.error.attributes[n];r.setAttribute(isNaN(n)?n:o,!isNaN(n)||o)}this.form.appendChild(r)}},{key:"toBracketNotation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return e.includes(t)?e.split(t).map((function(e,t){return 0===t?e:"[".concat(e,"]")})).join(""):e}},{key:"generateRandomString",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",i=0;i<e;i++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}},{key:"subscribe",value:function(e,t){this.subscribers[e]=this.subscribers[e]||[],this.subscribers[e].push(t)}},{key:"unsubscribe",value:function(e,t){this.subscribers[e]&&(this.subscribers[e]=this.subscribers[e].filter((function(e){return e!==t})))}},{key:"dispatch",value:function(e,t){this.subscribers[e]&&this.subscribers[e].forEach((function(e){return e(t)}))}},{key:"debounce",value:function(e,t){var i;return function(){for(var r=this,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];clearTimeout(i),i=setTimeout((function(){return e.apply(r,o)}),t)}}}],[{key:"registerElement",value:function(e,t){"function"==typeof t?this[e]=t:console.error('Invalid element class for "'.concat(e,'". Must be a constructor.'))}}])}();return o(M,"ZkErrorElement",b),o(M,"ZkLabelElement",y),o(M,"ZkElement",g),o(M,"ZkFileElement",E),o(M,"ZkRadioElement",O),o(M,"ZkCheckboxElement",k),o(M,"ZkSelectElement",w),o(M,"ZkItemgroupElement",B),o(M,"ZkGroupElement",j),o(M,"ZkMultipleElement",T),o(M,"ZkMultipleActionElement",A),o(M,"ZkTabElement",C),o(M,"ZkButtons",x),o(M,"ZkAction",N),t.default})()));