!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ZkFormBuilder=e():t.ZkFormBuilder=e()}(this,(()=>(()=>{"use strict";var t={d:(e,i)=>{for(var r in i)t.o(i,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:i[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)}return i}function n(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function o(t,e,i){return(e=v(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t,e,r){return e=s(e),function(t,e){if(e&&("object"==i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,a()?Reflect.construct(e,r||[],s(t).constructor):e.apply(t,r))}function a(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(a=function(){return!!t})()}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function f(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return c(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return l=t.done,t},e:function(t){a=!0,o=t},f:function(){try{l||null==i.return||i.return()}finally{if(a)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,v(r.key),r)}}function m(t,e,i){return e&&p(t.prototype,e),i&&p(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function v(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}t.d(e,{default:()=>N});var b=function(){return m((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,t),this.error=e||null,this.formBuilder=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.error||this.error.errors){var t,e=this.formBuilder.createWrapperElement(this.error.wrapper||[],this.context),i=f(this.error.errors);try{for(i.s();!(t=i.n()).done;){var r=t.value,n=document.createElement(this.error.tag||"span");for(var o in this.error.attributes){var l=this.error.attributes[o];n.setAttribute(isNaN(o)?o:l,!isNaN(o)||l)}n.appendChild(this.formBuilder.stringToHTML(this.error.before||"")),n.appendChild(this.formBuilder.stringToHTML(r)),n.appendChild(this.formBuilder.stringToHTML(this.error.after||"")),e.appendChild(n)}}catch(t){i.e(t)}finally{i.f()}}}},{key:"position",value:function(){var t;return(null===(t=this.error)||void 0===t?void 0:t.position)||"after-input"}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"after-input";return this.error&&this.position()===t?this.context:""}}])}(),y=function(){return m((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,t),this.label=e||null,this.formBuilder=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.label){var t=this.formBuilder.createWrapperElement(this.label.wrapper||[],this.context),e=document.createElement(this.label.tag);for(var i in this.label.attributes){var r=this.label.attributes[i];e.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}e.appendChild(this.formBuilder.stringToHTML(this.label.before||"")),e.appendChild(document.createTextNode(this.label.text)),e.appendChild(this.formBuilder.stringToHTML(this.label.after||"")),t.appendChild(e)}}},{key:"position",value:function(){var t;return(null===(t=this.label)||void 0===t?void 0:t.position)||"before-input"}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"before-input";return this.label&&this.position()===t?this.context:""}}])}(),g=function(){return m((function t(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,t),this.field=e||null,this.viewOnly=(null===(i=this.field)||void 0===i?void 0:i.viewOnly)||!1,this.formBuilder=r,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.field){var t=this.formBuilder.createElementInstance(this.field.label,this),e=this.formBuilder.createElementInstance(this.field.error,this),i=this.viewOnly||"multiple"!==this.field.type?null:this.formBuilder.createElementInstance(this.field.addAction,this);this.formBuilder.renderElementInPosition(this.context,t,"before-wrapper"),this.formBuilder.renderElementInPosition(this.context,e,"before-wrapper"),this.formBuilder.renderElementInPosition(this.context,i,"before-wrapper");var r=this.formBuilder.createWrapperElement(this.field.wrapper||[],this.context);this.formBuilder.renderElementInPosition(r,t,"before-input"),this.formBuilder.renderElementInPosition(r,e,"before-input"),this.formBuilder.renderElementInPosition(r,i,"before"),this.buildField(r),this.formBuilder.renderElementInPosition(r,i,"after"),this.formBuilder.renderElementInPosition(r,e,"after-input"),this.formBuilder.renderElementInPosition(r,t,"after-input"),this.formBuilder.renderElementInPosition(this.context,i,"after-wrapper"),this.formBuilder.renderElementInPosition(this.context,t,"after-wrapper"),this.formBuilder.renderElementInPosition(this.context,e,"after-wrapper")}}},{key:"buildField",value:function(t){var e=this.formBuilder.createWrapperElement(this.field.inputWrapper||[],t);e.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var i="";if(this.viewOnly&&this.field.view)i=this.formBuilder.stringToHTML(this.field.view);else if(this.viewOnly&&!["checkbox","radio"].includes(this.field.type))if((i=document.createElement("div")).setAttribute("data-view-only","true"),"file"===this.field.type){i.setAttribute("data-multiple",this.field.multiple?"true":"false"),i.setAttribute("class","frm-view-only type-".concat(this.field.type));var r=document.createElement("ul");r.setAttribute("class","file-list list-unstyled");var n,o=f(this.field.files);try{for(o.s();!(n=o.n()).done;){var l=n.value,a=document.createElement("li");a.setAttribute("class","file-item");var s=document.createElement("a");s.setAttribute("href",l),s.setAttribute("target","_blank");var u=l.split("/").pop();s.append(u),a.append(s),r.appendChild(a)}}catch(t){o.e(t)}finally{o.f()}i.append(r)}else i.setAttribute("class","form-control frm-view-only type-".concat(this.field.type)),i.append(this.field.value);else i=document.createElement("textarea"===this.field.type?"textarea":"input"),this.setElementAttributes(i),this.viewOnly&&["checkbox","radio"].includes(this.field.type)&&(i.setAttribute("readonly","readonly"),i.setAttribute("disabled","disabled"),i.setAttribute("data-view-only","true"));e.appendChild(i),e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}},{key:"setElementAttributes",value:function(t){for(var e in"textarea"!==this.field.type&&t.setAttribute("type",this.field.type),this.field.attributes){var i=this.field.attributes[e];t.setAttribute(isNaN(e)?e:i,!isNaN(e)||i)}this.field.rules&&t.setAttribute("data-rules",JSON.stringify(this.field.rules)),this.field.messages&&t.setAttribute("data-messages",JSON.stringify(this.field.messages)),null!==this.field.value&&("textarea"===this.field.type?t.innerHTML=this.field.value:"file"!==this.field.type&&t.setAttribute("value",this.field.value))}},{key:"render",value:function(){return this.context}}])}(),E=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,e),l(this,e,[t,i])}return u(e,t),m(e)}(g),O=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,e),l(this,e,[t,i])}return u(e,t),m(e)}(g),k=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,e),l(this,e,[t,i])}return u(e,t),m(e)}(g),w=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,e),l(this,e,[t,i])}return u(e,t),m(e,[{key:"buildField",value:function(t){var e=this.formBuilder.createWrapperElement(this.field.inputWrapper||[],t);e.appendChild(this.formBuilder.stringToHTML(this.field.before||"")),this.viewOnly?this.createViewOnlyElement(e):this.createSelectElement(e),e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}},{key:"createViewOnlyElement",value:function(t){if(this.field.view){var e=this.formBuilder.stringToHTML(this.field.view);t.appendChild(e)}else{var i=document.createElement("div");i.setAttribute("class","frm-view-only type-".concat(this.field.type)),i.setAttribute("data-view-only","true"),i.setAttribute("data-multiselect",this.isMultiselect()?"true":"false");var r=document.createElement("ul");if(r.setAttribute("class","list-unstyled"),this.field.options){var n,o=f(this.field.options);try{for(o.s();!(n=o.n()).done;){var l=n.value;if(l.optgroup){var a,s=f(l.options);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.selected){var d=document.createElement("li");d.append(u.label),r.appendChild(d)}}}catch(t){s.e(t)}finally{s.f()}}else if(l.selected){var c=document.createElement("li");c.append(l.label),r.appendChild(c)}}}catch(t){o.e(t)}finally{o.f()}}i.append(r),t.appendChild(i)}}},{key:"createSelectElement",value:function(t){var e=document.createElement("select");for(var i in this.field.attributes){var r=this.field.attributes[i];e.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}if(this.field.rules&&e.setAttribute("data-rules",JSON.stringify(this.field.rules)),this.field.messages&&e.setAttribute("data-messages",JSON.stringify(this.field.messages)),this.field.options){var n,o=f(this.field.options);try{for(o.s();!(n=o.n()).done;){var l=n.value;if(l.optgroup){var a=this.createOptGroupElement(l);e.appendChild(a)}else{var s=this.createOptionElement(l);e.appendChild(s)}}}catch(t){o.e(t)}finally{o.f()}}t.appendChild(e)}},{key:"isMultiselect",value:function(){return this.field.multiselect}},{key:"optionAttributes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i={};for(var r in t)e.includes(r)||(i[r]=t[r]);return i}},{key:"isSelected",value:function(t){return null!==t&&null!==this.field.value&&(this.isMultiselect()&&this.field.value.includes(t)||!this.isMultiselect()&&this.field.value==t)}},{key:"createOptGroupElement",value:function(t){var e=document.createElement("optgroup");e.label=t.label;var i=this.optionAttributes(t,["label","optgroup","options"]);for(var r in i){var n=i[r];e.setAttribute(isNaN(r)?r:n,!isNaN(r)||n)}var o,l=f(t.options);try{for(l.s();!(o=l.n()).done;){var a=o.value,s=this.createOptionElement(a);e.appendChild(s)}}catch(t){l.e(t)}finally{l.f()}return e}},{key:"createOptionElement",value:function(t){var e=document.createElement("option");e.value=t.value,e.text=t.label;var i=this.optionAttributes(t,["label","value"]);for(var r in i){var n=i[r];e.setAttribute(isNaN(r)?r:n,!isNaN(r)||n)}return e}}])}(g),B=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,e),l(this,e,[t,i])}return u(e,t),m(e,[{key:"buildField",value:function(t){t.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var e,i=this.formBuilder.createWrapperElement(this.field.itemWrapper||[],t),r=f(this.field.items);try{for(r.s();!(e=r.n()).done;){var n=e.value,o=this.formBuilder.createElementInstance(n).render();o&&i.appendChild(o)}}catch(t){r.e(t)}finally{r.f()}t.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}}])}(g),j=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,e),l(this,e,[t,i])}return u(e,t),m(e,[{key:"buildField",value:function(t){t.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var e,i=this.formBuilder.createWrapperElement(this.field.fieldWrapper||[],t),r=f(this.field.fields);try{for(r.s();!(e=r.n()).done;){var n=e.value,o=this.formBuilder.createElementInstance(n).render();o&&i.appendChild(o)}}catch(t){r.e(t)}finally{r.f()}t.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}}])}(g),T=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,e),l(this,e,[t,i])}return u(e,t),m(e,[{key:"buildField",value:function(t){t.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var e,i=this.formBuilder.createWrapperElement(this.field.contentWrapper||[],t),r=f(this.field.rows||[]);try{for(r.s();!(e=r.n()).done;){var n=e.value;this.buildRow(i,n)}}catch(t){r.e(t)}finally{r.f()}t.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}},{key:"buildRow",value:function(t,e){var i=this.viewOnly?null:this.formBuilder.createElementInstance(e.removeAction),r=this.formBuilder.createWrapperElement(e.wrapper.wrapper||[],t);this.formBuilder.renderElementInPosition(r,i,"before");var n,o=e.wrapper.fieldWrapper||[],l=this.formBuilder.createWrapperElement(o.wrapper||[],r),a=f(e.fields);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=this.formBuilder.createElementInstance(s).render();u&&l.appendChild(u)}}catch(t){a.e(t)}finally{a.f()}return this.formBuilder.renderElementInPosition(r,i,"after"),r}}])}(g),A=function(){return m((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;h(this,t),this.action=e||null,this.formBuilder=i,this.parent=r,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.action&&this.action.show){var t=this.formBuilder.createWrapperElement(this.action.wrapper||[],this.context),e=document.createElement(this.action.tag);for(var i in this.action.attributes){var r=this.action.attributes[i];e.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}this.action.rowObject&&e.setAttribute("data-row-object",JSON.stringify(this.action.rowObject)),e.appendChild(this.formBuilder.stringToHTML(this.action.label||"")),t.appendChild(e)}}},{key:"position",value:function(){var t;return(null===(t=this.action)||void 0===t?void 0:t.position)||"before"}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"before";return this.action&&this.position()===t?this.context:""}}])}(),C=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,e),l(this,e,[t,i])}return u(e,t),m(e,[{key:"buildField",value:function(t){t.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var e,i=this.formBuilder.createWrapperElement(this.field.tabWrapper||[],t),r=f(this.field.tabs);try{for(r.s();!(e=r.n()).done;){var n=e.value;this.formBuilder.createWrapperElement(n.itemWrapper.wrapper||[],i).appendChild(this.formBuilder.stringToHTML(n.label))}}catch(t){r.e(t)}finally{r.f()}var o,l=this.formBuilder.createWrapperElement(this.field.contentWrapper||[],t),a=f(this.field.tabs);try{for(a.s();!(o=a.n()).done;){var s,u=o.value,d=this.formBuilder.createWrapperElement(u.panelWrapper.wrapper||[],l),c=f(u.fields);try{for(c.s();!(s=c.n()).done;){var h=s.value,p=this.formBuilder.createElementInstance(h).render();p&&d.appendChild(p)}}catch(t){c.e(t)}finally{c.f()}}}catch(t){a.e(t)}finally{a.f()}t.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}}])}(g),x=function(){return m((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,t),this.buttons=e||null,this.formBuilder=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.buttons){var t=this.formBuilder.createWrapperElement(this.buttons.wrapper||[],this.context);this.buildActions(t)}}},{key:"buildActions",value:function(t){var e,i=f(this.buttons.actions);try{for(i.s();!(e=i.n()).done;){var r=e.value,n=this.formBuilder.createButtonInstance(r).render();n&&t.appendChild(n)}}catch(t){i.e(t)}finally{i.f()}}},{key:"position",value:function(){var t;return null!==(t=this.buttons)&&void 0!==t&&t.position?this.buttons.position:"form-bottom"}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form-bottom";return this.buttons&&this.position()===t?this.context:""}}])}(),F=function(){return m((function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,t),this.action=e,this.formBuilder=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.action){var t=this.formBuilder.createWrapperElement(this.action.wrapper||[],this.context),e=document.createElement(this.action.tag);for(var i in this.action.attributes){var r=this.action.attributes[i];e.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}e.appendChild(this.formBuilder.stringToHTML(this.action.before||"")),e.appendChild(this.formBuilder.stringToHTML(this.action.text)),e.appendChild(this.formBuilder.stringToHTML(this.action.after||"")),t.appendChild(e)}}},{key:"render",value:function(){return this.context}}])}(),N=function(){function t(){var e,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h(this,t),o(this,"form",null),o(this,"validator",null),o(this,"frmObj",null),o(this,"frmContainer",null),o(this,"context",null),o(this,"options",{multiple:{addButton:'[data-action="add-row"]',removeButton:'[data-action="remove-row"]'},loading:'<div class="text-center m-4">Loading...</div>'}),o(this,"subscribers",{}),o(this,"subscribersData",{}),this.setOptions(r),this.setValidatorObj("undefined"!=typeof ZkFormValidator&&ZkFormValidator||(null===(e=window)||void 0===e?void 0:e.ZkFormValidator)||(null===(i=window)||void 0===i||null===(i=i.ZkValidator)||void 0===i?void 0:i.ZkFormValidator)||null),this.context=document.createDocumentFragment()}return m(t,[{key:"setOptions",value:function(t){this.options=n(n({},this.options),t)}},{key:"getOptions",value:function(){return this.options}},{key:"getForm",value:function(){return this.form}},{key:"setForm",value:function(t){null==(t="string"==typeof t?document.getElementById(t):t)||t&&"FORM"!==t.tagName?console.error("Form not found"):(this.form=t,this.initMultiple(),!this.validator&&this.validatorObj&&(this.validator=new this.validatorObj(this.form)))}},{key:"setValidatorObj",value:function(t){this.validatorObj=t}},{key:"getValidatorObj",value:function(){return this.validatorObj}},{key:"setValidator",value:function(t){this.validator=t}},{key:"getValidator",value:function(){return this.validator}},{key:"validate",value:function(){return!this.validator||this.validator.validate()}},{key:"setFormObject",value:function(t){this.frmObj="string"==typeof t?JSON.parse(t):t}},{key:"render",value:function(t,e){if(this.frmContainer=document.getElementById(t)||document.querySelector(t),!this.frmContainer)return this.dispatch("beforeRender",{status:"error",message:"Container not found"}),void console.error("Container not found");this.generate(e)}},{key:"generate",value:function(t){t&&this.setFormObject(t),this.dispatch("beforeRender",{status:"success",container:this.frmContainer,frmObj:this.frmObj}),this.frmContainer.innerHTML="",this.frmContainer.appendChild(this.stringToHTML(this.options.loading)),this.buildForm(),this.frmContainer.innerHTML="",this.frmContainer.appendChild(this.context),this.validatorObj&&(this.validator=new this.validatorObj(this.form)),this.initMultiple(),this.dispatch("afterRender",{status:"success",container:this.frmContainer}),this.frmObj=null}},{key:"buildForm",value:function(){var t;if(!this.frmObj)return this.dispatch("beforeBuildForm",{status:"error",message:"Form object not found"}),void console.error("Form object not found");this.context=document.createDocumentFragment();var e=this.createWrapperElement((null===(t=this.frmObj)||void 0===t?void 0:t.wrapper)||[],this.context);for(var i in e.appendChild(this.stringToHTML(this.frmObj.beforeRender||"")),this.form=document.createElement("form"),this.dispatch("beforeBuildForm",{status:"success",form:this.form}),this.form.appendChild(this.stringToHTML(this.frmObj.before||"")),this.frmObj.action&&this.form.setAttribute("action",this.frmObj.action),this.form.setAttribute("method","GET"===this.frmObj.method?"GET":"POST"),this.frmObj.attributes){var r=this.frmObj.attributes[i];this.form.setAttribute(isNaN(i)?i:r,!isNaN(i)||r)}this.addFormHiddenFields();var n=this.createElementInstance(this.frmObj.buttons,this);this.renderElementInPosition(this.form,n,"form-top"),this.buildField(this.frmObj.fields),this.renderElementInPosition(this.form,n,"form-bottom"),this.form.appendChild(this.stringToHTML(this.frmObj.after||"")),e.appendChild(this.form),e.appendChild(this.stringToHTML(this.frmObj.afterRender||"")),this.dispatch("afterBuildForm",{status:"success",form:this.form})}},{key:"buildField",value:function(t){if(Array.isArray(t)){var e,i=f(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.buildField(r)}}catch(t){i.e(t)}finally{i.f()}}else{var n=this.createElementInstance(t);this.renderElement(this.form,n)}}},{key:"createElementInstance",value:function(e){if(!e||null==e||!e.jsElement)return null;var i=this[e.jsElement]||t[e.jsElement]||null;if(!i)return console.error("".concat(e.jsElement," class not found")),null;for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return function(t,e,i){if(a())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var n=new(t.bind.apply(t,r));return i&&d(n,i.prototype),n}(i,[e,this].concat(n))}},{key:"createButtonInstance",value:function(e){if(!e||null==e||!e.jsElement)return null;var i=this[e.jsElement]||t[e.jsElement];return i?new i(e,this):(console.error("".concat(e.jsElement," class not found")),null)}},{key:"renderElement",value:function(t,e){if(e){var i=e.render();i&&t.appendChild(i)}}},{key:"renderElementInPosition",value:function(t,e,i){if(e){var r=e.render(i);r&&t.appendChild(r)}}},{key:"createWrapperElement",value:function(t,e){var i,r=e,n=f(t);try{for(n.s();!(i=n.n()).done;){var o=i.value;o.before&&r.appendChild(this.stringToHTML(o.before));var l=document.createElement(o.tag);this.setAttributesFromString(l,o.attributes),r.appendChild(l),o.after&&r.appendChild(this.stringToHTML(o.after)),r=l}}catch(t){n.e(t)}finally{n.f()}return r}},{key:"stringToHTML",value:function(t){if(!t)return document.createDocumentFragment();var e=document.createElement("template");return e.innerHTML=(""+t).trim(),e.content}},{key:"setAttributesFromString",value:function(t,e){if(e){var i,r=f(e.matchAll(/([a-zA-Z0-9-]+)(?:=["']([^"']*)["'])?/g));try{for(r.s();!(i=r.n()).done;){var n=i.value;t.setAttribute(n[1],n[2]||!0)}}catch(t){r.e(t)}finally{r.f()}}}},{key:"addMoreEvent",value:function(t){var e,i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||t.getAttribute("data-add-prefix"),l=r||t.getAttribute("data-row-object");"string"==typeof l&&(l=JSON.parse(l));var a=n||(null===(e=l)||void 0===e?void 0:e.jsElement)||t.getAttribute("data-js-element");if(a&&o&&l){var s=this.form.querySelector('[data-prefix="'.concat(o,'"]'));if(s){var u=this.debounce((function(t){t.preventDefault();var e=i.createElementInstance({jsElement:a});if(e){var r=l.name,n=l.rowPrefix||i.toBracketNotation(r),u=i.generateRandomString(),d=(new Date).getTime(),f=JSON.stringify(l);f=(f=(f=f.replaceAll(r,r.replaceAll("{{index}}","{{".concat(u,"}}")))).replaceAll(n,n.replaceAll("{{index}}","{{".concat(u,"}}")))).replaceAll("{{".concat(u,"}}"),d);var c=e.buildRow(document.createDocumentFragment(),JSON.parse(f));s.appendChild(c),c.querySelectorAll(i.options.multiple.addButton).forEach((function(t){i.addMoreEvent(t)})),c.querySelectorAll(i.options.multiple.removeButton).forEach((function(t){i.addRemoveEvent(t)})),i.validator&&i.validator.addContextFields&&i.validator.addContextFields(c),i.dispatch("addRow",{_container:o,context:c,rowName:r,rowPrefix:n,uniqueId:u,timeStr:d})}}),150);t.removeEventListener("click",u),t.addEventListener("click",u)}}}},{key:"addRemoveEvent",value:function(t){var e=this,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||t.getAttribute("data-remove-prefix");if(i){var r=this.debounce((function(t){t.preventDefault();var r=e.form.querySelector('[data-row-prefix="'.concat(i,'"]'));r&&(e.validator.removeContextFields(r),e.dispatch("removeRow",{_container:i,context:r}),r.remove())}),100);t.removeEventListener("click",r),t.addEventListener("click",r)}}},{key:"initMultiple",value:function(){var t=this;this.form.querySelectorAll(this.options.multiple.addButton).forEach((function(e){t.addMoreEvent(e)})),this.form.querySelectorAll(this.options.multiple.removeButton).forEach((function(e){t.addRemoveEvent(e)}))}},{key:"addFormHiddenFields",value:function(){this.frmObj.csrf&&this.addHiddenField("_token",this.frmObj.csrf_token),this.frmObj.frmKey&&this.addHiddenField("_form",this.frmObj.frmKey),["GET","POST"].includes(this.frmObj.method)||this.addHiddenField("_method",this.frmObj.method),this.frmObj.key&&this.addHiddenField("_key",this.frmObj.key),this.frmObj.metaData&&this.addHiddenField("_metaData",this.frmObj.metaData)}},{key:"addHiddenField",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.createElement("input");for(var n in r.setAttribute("type","hidden"),r.setAttribute("name",t),r.setAttribute("value",e),i){var o=this.error.attributes[n];r.setAttribute(isNaN(n)?n:o,!isNaN(n)||o)}this.form.appendChild(r)}},{key:"toBracketNotation",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return t.includes(e)?t.split(e).map((function(t,e){return 0===e?t:"[".concat(t,"]")})).join(""):t}},{key:"generateRandomString",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,e="",i=0;i<t;i++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return e}},{key:"subscribe",value:function(t,e){this.subscribers[t]=this.subscribers[t]||[],this.subscribers[t].push(e)}},{key:"unsubscribe",value:function(t,e){this.subscribers[t]&&(this.subscribers[t]=this.subscribers[t].filter((function(t){return t!==e})))}},{key:"dispatch",value:function(t,e){this.subscribers[t]&&this.subscribers[t].forEach((function(t){return t(e)}))}},{key:"debounce",value:function(t,e){var i;return function(){for(var r=this,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];clearTimeout(i),i=setTimeout((function(){return t.apply(r,o)}),e)}}}],[{key:"registerElement",value:function(t,e){"function"==typeof e?this[t]=e:console.error('Invalid element class for "'.concat(t,'". Must be a constructor.'))}}])}();return o(N,"ZkErrorElement",b),o(N,"ZkLabelElement",y),o(N,"ZkElement",g),o(N,"ZkFileElement",E),o(N,"ZkRadioElement",O),o(N,"ZkCheckboxElement",k),o(N,"ZkSelectElement",w),o(N,"ZkItemgroupElement",B),o(N,"ZkGroupElement",j),o(N,"ZkMultipleElement",T),o(N,"ZkMultipleActionElement",A),o(N,"ZkTabElement",C),o(N,"ZkButtons",x),o(N,"ZkAction",F),e.default})()));