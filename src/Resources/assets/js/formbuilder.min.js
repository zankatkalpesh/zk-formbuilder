!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ZkFormBuilder=t():e.ZkFormBuilder=t()}(this,(()=>(()=>{"use strict";var e={d:(t,r)=>{for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t,i){return t=s(t),function(e,t){if(t&&("object"==r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,a()?Reflect.construct(t,i||[],s(e).constructor):t.apply(e,i))}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(a=function(){return!!e})()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){a=!0,o=e},f:function(){try{l||null==r.return||r.return()}finally{if(a)throw o}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,v(i.key),i)}}function p(e,t,r){return t&&m(e.prototype,t),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}e.d(t,{default:()=>M});var b=function(){return p((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.error=t||null,this.formBuilder=r,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.error||this.error.errors){var e,t=this.formBuilder.createWrapperElement(this.error.wrapper||[],this.context),r=f(this.error.errors);try{for(r.s();!(e=r.n()).done;){var i=e.value,n=document.createElement(this.error.tag||"span");this.formBuilder.setAttributesFromObject(n,this.error.attributes),n.appendChild(this.formBuilder.stringToHTML(this.error.before||"")),n.appendChild(this.formBuilder.stringToHTML(i)),n.appendChild(this.formBuilder.stringToHTML(this.error.after||"")),t.appendChild(n)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"position",value:function(){var e;return(null===(e=this.error)||void 0===e?void 0:e.position)||"after-input"}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"after-input";return this.error&&this.position()===e?this.context:""}}])}(),y=function(){return p((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.label=t||null,this.formBuilder=r,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.label){var e=this.formBuilder.createWrapperElement(this.label.wrapper||[],this.context),t=document.createElement(this.label.tag);this.formBuilder.setAttributesFromObject(t,this.label.attributes),t.appendChild(this.formBuilder.stringToHTML(this.label.before||"")),t.appendChild(document.createTextNode(this.label.text)),t.appendChild(this.formBuilder.stringToHTML(this.label.after||"")),e.appendChild(t)}}},{key:"position",value:function(){var e;return(null===(e=this.label)||void 0===e?void 0:e.position)||"before-input"}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"before-input";return this.label&&this.position()===e?this.context:""}}])}(),g=function(){return p((function e(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.field=t||null,this.viewOnly=(null===(r=this.field)||void 0===r?void 0:r.viewOnly)||!1,this.formBuilder=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.field){var e=this.formBuilder.createElementInstance(this.field.label,this),t=this.formBuilder.createElementInstance(this.field.error,this),r=this.viewOnly||"multiple"!==this.field.type?null:this.formBuilder.createElementInstance(this.field.addAction,this);this.formBuilder.renderElementInPosition(this.context,e,"before-wrapper"),this.formBuilder.renderElementInPosition(this.context,t,"before-wrapper"),this.formBuilder.renderElementInPosition(this.context,r,"before-wrapper");var i=this.formBuilder.createWrapperElement(this.field.wrapper||[],this.context);this.formBuilder.renderElementInPosition(i,e,"before-input"),this.formBuilder.renderElementInPosition(i,t,"before-input"),this.formBuilder.renderElementInPosition(i,r,"before"),this.buildField(i),this.formBuilder.renderElementInPosition(i,r,"after"),this.formBuilder.renderElementInPosition(i,t,"after-input"),this.formBuilder.renderElementInPosition(i,e,"after-input"),this.formBuilder.renderElementInPosition(this.context,r,"after-wrapper"),this.formBuilder.renderElementInPosition(this.context,e,"after-wrapper"),this.formBuilder.renderElementInPosition(this.context,t,"after-wrapper")}}},{key:"buildField",value:function(e){var t=this.formBuilder.createWrapperElement(this.field.inputWrapper||[],e);t.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var r="";if(this.viewOnly&&this.field.view)r=this.formBuilder.stringToHTML(this.field.view);else if(this.viewOnly&&!["checkbox","radio"].includes(this.field.type))if((r=document.createElement("div")).setAttribute("data-view-only","true"),"file"===this.field.type){r.setAttribute("data-multiple",this.field.multiple?"true":"false"),r.setAttribute("class","frm-view-only type-".concat(this.field.type));var i=document.createElement("ul");i.setAttribute("class","file-list list-unstyled");var n,o=f(this.field.files);try{for(o.s();!(n=o.n()).done;){var l=n.value,a=document.createElement("li");a.setAttribute("class","file-item");var s=document.createElement("a");s.setAttribute("href",l),s.setAttribute("target","_blank");var u=l.split("/").pop();s.append(u),a.append(s),i.appendChild(a)}}catch(e){o.e(e)}finally{o.f()}r.append(i)}else r.setAttribute("class","form-control frm-view-only type-".concat(this.field.type)),r.append(this.field.value);else r=document.createElement("textarea"===this.field.type?"textarea":"input"),this.setElementAttributes(r),this.viewOnly&&["checkbox","radio"].includes(this.field.type)&&(r.setAttribute("readonly","readonly"),r.setAttribute("disabled","disabled"),r.setAttribute("data-view-only","true"));t.appendChild(r),t.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}},{key:"setElementAttributes",value:function(e){"textarea"!==this.field.type&&e.setAttribute("type",this.field.type),this.formBuilder.setAttributesFromObject(e,this.field.attributes),this.field.rules&&e.setAttribute("data-rules",JSON.stringify(this.field.rules)),this.field.messages&&e.setAttribute("data-messages",JSON.stringify(this.field.messages)),null!==this.field.value&&("textarea"===this.field.type?e.innerHTML=this.field.value:"file"!==this.field.type&&e.setAttribute("value",this.field.value))}},{key:"render",value:function(){return this.context}}])}(),E=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,r])}return u(t,e),p(t)}(g),O=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,r])}return u(t,e),p(t)}(g),w=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,r])}return u(t,e),p(t)}(g),k=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,r])}return u(t,e),p(t,[{key:"buildField",value:function(e){var t=this.formBuilder.createWrapperElement(this.field.inputWrapper||[],e);t.appendChild(this.formBuilder.stringToHTML(this.field.before||"")),this.viewOnly?this.createViewOnlyElement(t):this.createSelectElement(t),t.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}},{key:"createViewOnlyElement",value:function(e){if(this.field.view){var t=this.formBuilder.stringToHTML(this.field.view);e.appendChild(t)}else{var r=document.createElement("div");r.setAttribute("class","frm-view-only type-".concat(this.field.type)),r.setAttribute("data-view-only","true"),r.setAttribute("data-multiselect",this.isMultiselect()?"true":"false");var i=document.createElement("ul");if(i.setAttribute("class","list-unstyled"),this.field.options){var n,o=f(this.field.options);try{for(o.s();!(n=o.n()).done;){var l=n.value;if(l.optgroup){var a,s=f(l.options);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.selected){var d=document.createElement("li");d.append(u.label),i.appendChild(d)}}}catch(e){s.e(e)}finally{s.f()}}else if(l.selected){var c=document.createElement("li");c.append(l.label),i.appendChild(c)}}}catch(e){o.e(e)}finally{o.f()}}r.append(i),e.appendChild(r)}}},{key:"createSelectElement",value:function(e){var t=document.createElement("select");if(this.formBuilder.setAttributesFromObject(t,this.field.attributes),this.field.rules&&t.setAttribute("data-rules",JSON.stringify(this.field.rules)),this.field.messages&&t.setAttribute("data-messages",JSON.stringify(this.field.messages)),this.field.options){var r,i=f(this.field.options);try{for(i.s();!(r=i.n()).done;){var n=r.value;if(n.optgroup){var o=this.createOptGroupElement(n);t.appendChild(o)}else{var l=this.createOptionElement(n);t.appendChild(l)}}}catch(e){i.e(e)}finally{i.f()}}e.appendChild(t)}},{key:"isMultiselect",value:function(){return this.field.multiselect}},{key:"optionAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r={};for(var i in e)t.includes(i)||(r[i]=e[i]);return r}},{key:"isSelected",value:function(e){return null!==e&&null!==this.field.value&&(this.isMultiselect()&&this.field.value.includes(e)||!this.isMultiselect()&&this.field.value==e)}},{key:"createOptGroupElement",value:function(e){var t=document.createElement("optgroup");t.label=e.label;var r=this.optionAttributes(e,["label","optgroup","options"]);this.formBuilder.setAttributesFromObject(t,r);var i,n=f(e.options);try{for(n.s();!(i=n.n()).done;){var o=i.value,l=this.createOptionElement(o);t.appendChild(l)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"createOptionElement",value:function(e){var t=document.createElement("option");t.value=e.value,t.text=e.label;var r=this.optionAttributes(e,["label","value"]);return this.formBuilder.setAttributesFromObject(t,r),t}}])}(g),j=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,r])}return u(t,e),p(t,[{key:"buildField",value:function(e){e.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var t,r=this.formBuilder.createWrapperElement(this.field.itemWrapper||[],e),i=f(this.field.items);try{for(i.s();!(t=i.n()).done;){var n=t.value,o=this.formBuilder.createElementInstance(n).render();o&&r.appendChild(o)}}catch(e){i.e(e)}finally{i.f()}e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}}])}(g),B=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,r])}return u(t,e),p(t,[{key:"buildField",value:function(e){e.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var t,r=this.formBuilder.createWrapperElement(this.field.fieldWrapper||[],e),i=f(this.field.fields);try{for(i.s();!(t=i.n()).done;){var n=t.value,o=this.formBuilder.createElementInstance(n).render();o&&r.appendChild(o)}}catch(e){i.e(e)}finally{i.f()}e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}}])}(g),A=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,r])}return u(t,e),p(t,[{key:"buildField",value:function(e){e.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var t,r=this.formBuilder.createWrapperElement(this.field.contentWrapper||[],e),i=f(this.field.rows||[]);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.buildRow(r,n)}}catch(e){i.e(e)}finally{i.f()}e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}},{key:"buildRow",value:function(e,t){var r=this.viewOnly?null:this.formBuilder.createElementInstance(t.removeAction),i=this.formBuilder.createWrapperElement(t.wrapper.wrapper||[],e);this.formBuilder.renderElementInPosition(i,r,"before");var n,o=t.wrapper.fieldWrapper||[],l=this.formBuilder.createWrapperElement(o.wrapper||[],i),a=f(t.fields);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=this.formBuilder.createElementInstance(s).render();u&&l.appendChild(u)}}catch(e){a.e(e)}finally{a.f()}return this.formBuilder.renderElementInPosition(i,r,"after"),i}}])}(g),T=function(){return p((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;h(this,e),this.action=t||null,this.formBuilder=r,this.parent=i,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.action&&this.action.show){var e=this.formBuilder.createWrapperElement(this.action.wrapper||[],this.context),t=document.createElement(this.action.tag);this.formBuilder.setAttributesFromObject(t,this.action.attributes),this.action.rowObject&&t.setAttribute("data-row-object",JSON.stringify(this.action.rowObject)),t.appendChild(this.formBuilder.stringToHTML(this.action.before||"")),t.appendChild(this.formBuilder.stringToHTML(this.action.text)),t.appendChild(this.formBuilder.stringToHTML(this.action.after||"")),e.appendChild(t)}}},{key:"position",value:function(){var e;return(null===(e=this.action)||void 0===e?void 0:e.position)||"before"}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"before";return this.action&&this.position()===e?this.context:""}}])}(),x=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return h(this,t),l(this,t,[e,r])}return u(t,e),p(t,[{key:"buildField",value:function(e){e.appendChild(this.formBuilder.stringToHTML(this.field.before||""));var t,r=this.formBuilder.createWrapperElement(this.field.tabWrapper||[],e),i=f(this.field.tabs);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.formBuilder.createWrapperElement(n.itemWrapper.wrapper||[],r).appendChild(this.formBuilder.stringToHTML(n.label))}}catch(e){i.e(e)}finally{i.f()}var o,l=this.formBuilder.createWrapperElement(this.field.contentWrapper||[],e),a=f(this.field.tabs);try{for(a.s();!(o=a.n()).done;){var s,u=o.value,d=this.formBuilder.createWrapperElement(u.panelWrapper.wrapper||[],l),c=f(u.fields);try{for(c.s();!(s=c.n()).done;){var h=s.value,m=this.formBuilder.createElementInstance(h).render();m&&d.appendChild(m)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){a.e(e)}finally{a.f()}e.appendChild(this.formBuilder.stringToHTML(this.field.after||""))}}])}(g),C=function(){return p((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.buttons=t||null,this.formBuilder=r,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.buttons){var e=this.formBuilder.createWrapperElement(this.buttons.wrapper||[],this.context);this.buildActions(e)}}},{key:"buildActions",value:function(e){var t,r=f(this.buttons.actions);try{for(r.s();!(t=r.n()).done;){var i=t.value,n=this.formBuilder.createButtonInstance(i).render();n&&e.appendChild(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"position",value:function(){var e;return null!==(e=this.buttons)&&void 0!==e&&e.position?this.buttons.position:"form-bottom"}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form-bottom";return this.buttons&&this.position()===e?this.context:""}}])}(),F=function(){return p((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;h(this,e),this.action=t,this.formBuilder=r,this.context=document.createDocumentFragment(),this.init()}),[{key:"init",value:function(){if(this.action){var e=this.formBuilder.createWrapperElement(this.action.wrapper||[],this.context),t=document.createElement(this.action.tag);this.formBuilder.setAttributesFromObject(t,this.action.attributes),t.appendChild(this.formBuilder.stringToHTML(this.action.before||"")),t.appendChild(this.formBuilder.stringToHTML(this.action.text)),t.appendChild(this.formBuilder.stringToHTML(this.action.after||"")),e.appendChild(t)}}},{key:"render",value:function(){return this.context}}])}(),M=function(){function e(){var t,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h(this,e),o(this,"form",null),o(this,"validator",null),o(this,"frmObj",null),o(this,"frmContainer",null),o(this,"context",null),o(this,"options",{multiple:{addButton:'[data-action="add-row"]',removeButton:'[data-action="remove-row"]'},loading:'<div class="text-center m-4">Loading...</div>'}),o(this,"subscribers",{}),o(this,"subscribersData",{}),this.setOptions(i),this.setValidatorObj("undefined"!=typeof ZkFormValidator&&ZkFormValidator||"undefined"!=typeof window&&(null===(t=window)||void 0===t?void 0:t.ZkFormValidator)||"undefined"!=typeof window&&(null===(r=window)||void 0===r||null===(r=r.ZkValidator)||void 0===r?void 0:r.ZkFormValidator)||null),this.context="undefined"!=typeof document&&document.createDocumentFragment()}return p(e,[{key:"setOptions",value:function(e){this.options=n(n({},this.options),e)}},{key:"getOptions",value:function(){return this.options}},{key:"getForm",value:function(){return this.form}},{key:"setForm",value:function(e){null==(e="string"==typeof e?document.getElementById(e):e)||e&&"FORM"!==e.tagName?console.error("Invalid form element provided."):(this.form=e,this.initMultiple(),!this.validator&&this.validatorObj&&(this.validator=new this.validatorObj(this.form)))}},{key:"setValidatorObj",value:function(e){this.validatorObj=e}},{key:"getValidatorObj",value:function(){return this.validatorObj}},{key:"setValidator",value:function(e){this.validator=e}},{key:"getValidator",value:function(){return this.validator}},{key:"validate",value:function(){return!this.validator||this.validator.validate()}},{key:"setFormObject",value:function(e){try{this.frmObj="string"==typeof e?JSON.parse(e):e}catch(e){console.error("Invalid JSON in setFormObject",e),this.frmObj=null}}},{key:"render",value:function(e,t){if(this.frmContainer=document.getElementById(e)||document.querySelector(e),!this.frmContainer)return this.dispatch("beforeRender",{status:"error",message:"Container not found"}),void console.error("Container not found");this.generate(t)}},{key:"generate",value:function(e){e&&this.setFormObject(e),this.dispatch("beforeRender",{status:"success",container:this.frmContainer,frmObj:this.frmObj}),this.frmContainer.innerHTML="",this.frmContainer.appendChild(this.stringToHTML(this.options.loading)),this.buildForm(),this.frmContainer.innerHTML="",this.frmContainer.appendChild(this.context),this.validatorObj&&(this.validator=new this.validatorObj(this.form)),this.initMultiple(),this.dispatch("afterRender",{status:"success",container:this.frmContainer}),this.frmObj=null}},{key:"buildForm",value:function(){var e;if(!this.frmObj)return this.dispatch("beforeBuildForm",{status:"error",message:"Form object not found"}),void console.error("Form object not found");this.context=document.createDocumentFragment();var t=this.createWrapperElement((null===(e=this.frmObj)||void 0===e?void 0:e.wrapper)||[],this.context);t.appendChild(this.stringToHTML(this.frmObj.beforeRender||"")),this.form=document.createElement("form"),this.dispatch("beforeBuildForm",{status:"success",form:this.form}),this.form.appendChild(this.stringToHTML(this.frmObj.before||"")),this.frmObj.action&&this.form.setAttribute("action",this.frmObj.action),this.form.setAttribute("method","GET"===this.frmObj.method?"GET":"POST"),this.setAttributesFromObject(this.form,this.frmObj.attributes),this.addFormHiddenFields();var r=this.createElementInstance(this.frmObj.buttons,this);this.renderElementInPosition(this.form,r,"form-top"),this.buildField(this.frmObj.fields),this.renderElementInPosition(this.form,r,"form-bottom"),this.form.appendChild(this.stringToHTML(this.frmObj.after||"")),t.appendChild(this.form),t.appendChild(this.stringToHTML(this.frmObj.afterRender||"")),this.dispatch("afterBuildForm",{status:"success",form:this.form})}},{key:"buildField",value:function(e){if(Array.isArray(e)){var t,r=f(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.buildField(i)}}catch(e){r.e(e)}finally{r.f()}}else{var n=this.createElementInstance(e);this.renderElement(this.form,n)}}},{key:"createElementInstance",value:function(t){if(!t||null==t||!t.jsElement)return null;var r=this[t.jsElement]||e[t.jsElement]||null;if(!r)return console.error("".concat(t.jsElement," class not found")),null;for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return function(e,t,r){if(a())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var n=new(e.bind.apply(e,i));return r&&d(n,r.prototype),n}(r,[t,this].concat(n))}},{key:"createButtonInstance",value:function(t){if(!t||null==t||!t.jsElement)return null;var r=this[t.jsElement]||e[t.jsElement];return r?new r(t,this):(console.error("".concat(t.jsElement," class not found")),null)}},{key:"renderElement",value:function(e,t){if(t){var r=t.render();r&&e.appendChild(r)}}},{key:"renderElementInPosition",value:function(e,t,r){if(t){var i=t.render(r);i&&e.appendChild(i)}}},{key:"createWrapperElement",value:function(e,t){var r,i=t,n=f(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;o.before&&i.appendChild(this.stringToHTML(o.before));var l=document.createElement(o.tag);this.setAttributesFromString(l,o.attributes),i.appendChild(l),o.after&&i.appendChild(this.stringToHTML(o.after)),i=l}}catch(e){n.e(e)}finally{n.f()}return i}},{key:"stringToHTML",value:function(e){if(!e)return document.createDocumentFragment();var t=document.createElement("template");return t.innerHTML=(""+e).trim(),t.content}},{key:"setAttributesFromString",value:function(e,t){if("string"==typeof t&&null!==t){var r,i=f(t.matchAll(/([a-zA-Z0-9-]+)(?:=["']([^"']*)["'])?/g));try{for(i.s();!(r=i.n()).done;){var n=r.value;e.setAttribute(n[1],n[2]||!0)}}catch(e){i.e(e)}finally{i.f()}}}},{key:"setAttributesFromObject",value:function(e,t){if("object"===r(t)&&null!==t)for(var i in t){var n=!isNaN(i);e.setAttribute(n?t[i]:i,!!n||t[i])}}},{key:"addMoreEvent",value:function(e){var t,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||e.getAttribute("data-container-prefix"),l=i||e.getAttribute("data-row-object");"string"==typeof l&&(l=JSON.parse(l));var a=n||(null===(t=l)||void 0===t?void 0:t.jsElement)||e.getAttribute("data-js-element");if(a&&o&&l){var s=this.form.querySelector('[data-content-prefix="'.concat(o,'"]'));if(s){var u=Number(l.max||e.getAttribute("data-max-row")||0),d=(l.maxMsg||e.getAttribute("data-max-msg")||"Maximum {max} rows are allowed.").replaceAll("{max}",u),f=this.debounce((function(e){e.preventDefault();var t=s.querySelectorAll("[data-row-prefix]").length;if(0!==u&&t===u)return r.dispatch("maxRowError",{_container:o,rowCount:t,max:u,message:d}),void(r.subscribers.maxRowError||alert(d));var i=r.createElementInstance({jsElement:a});if(i){var n=l.name,f=l.rowPrefix||r.toBracketNotation(n),c=r.generateRandomString(),h=(new Date).getTime(),m=JSON.stringify(l);m=(m=(m=m.replaceAll(n,n.replaceAll("{{index}}","{{".concat(c,"}}")))).replaceAll(f,f.replaceAll("{{index}}","{{".concat(c,"}}")))).replaceAll("{{".concat(c,"}}"),h);var p=i.buildRow(document.createDocumentFragment(),JSON.parse(m));s.appendChild(p),p.querySelectorAll(r.options.multiple.addButton).forEach((function(e){r.addMoreEvent(e)})),p.querySelectorAll(r.options.multiple.removeButton).forEach((function(e){r.addRemoveEvent(e)})),r.validator&&r.validator.addContextFields&&r.validator.addContextFields(p),r.dispatch("addRow",{_container:o,context:p,rowName:n,rowPrefix:f,uniqueId:c,timeStr:h})}}),150);e.removeEventListener("click",f),e.addEventListener("click",f)}}}},{key:"addRemoveEvent",value:function(e){var t=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||e.getAttribute("data-remove-prefix");if(i){var n=r||e.getAttribute("data-container-prefix"),o=this.form.querySelector('[data-content-prefix="'.concat(n,'"]'));if(o){var l=Number(e.getAttribute("data-min-row")||0),a=(e.getAttribute("data-min-msg")||(l>1?"Minimum {min} rows are required.":"At least one row is required.")).replaceAll("{min}",l),s=this.debounce((function(e){e.preventDefault();var r=o.querySelector('[data-row-prefix="'.concat(i,'"]'));if(r){var s=o.querySelectorAll("[data-row-prefix]").length;if(0!==l&&s===l)return t.dispatch("minRowError",{_container:n,_rowPrefix:i,context:r,rowCount:s,min:l,message:a}),void(t.subscribers.minRowError||alert(a));t.validator.removeContextFields(r),t.dispatch("removeRow",{_container:n,_rowPrefix:i,context:r}),r.remove()}}),100);e.removeEventListener("click",s),e.addEventListener("click",s)}}}},{key:"initMultiple",value:function(){var e=this;this.form.querySelectorAll(this.options.multiple.addButton).forEach((function(t){e.addMoreEvent(t)})),this.form.querySelectorAll(this.options.multiple.removeButton).forEach((function(t){e.addRemoveEvent(t)}))}},{key:"addFormHiddenFields",value:function(){this.frmObj.csrf&&this.addHiddenField("_token",this.frmObj.csrf_token),this.frmObj.frmKey&&this.addHiddenField("_form",this.frmObj.frmKey),["GET","POST"].includes(this.frmObj.method)||this.addHiddenField("_method",this.frmObj.method),this.frmObj.key&&this.addHiddenField("_key",this.frmObj.key),this.frmObj.metaData&&this.addHiddenField("_metaData",this.frmObj.metaData)}},{key:"addHiddenField",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",e),i.setAttribute("value",t),this.setAttributesFromObject(i,r),this.form.appendChild(i)}},{key:"toBracketNotation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".";return e.includes(t)?e.split(t).map((function(e,t){return 0===t?e:"[".concat(e,"]")})).join(""):e}},{key:"generateRandomString",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",r=0;r<e;r++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}},{key:"on",value:function(e,t){this.subscribe(e,t)}},{key:"subscribe",value:function(e,t){this.subscribers[e]=this.subscribers[e]||[],this.subscribers[e].push(t)}},{key:"unsubscribe",value:function(e,t){this.subscribers[e]&&(this.subscribers[e]=this.subscribers[e].filter((function(e){return e!==t})))}},{key:"dispatch",value:function(e,t){this.subscribers[e]&&this.subscribers[e].forEach((function(e){return e(t)}))}},{key:"debounce",value:function(e,t){var r;return function(){for(var i=this,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];clearTimeout(r),r=setTimeout((function(){return e.apply(i,o)}),t)}}}],[{key:"registerElement",value:function(e,t){"function"==typeof t?this[e]=t:console.error('Invalid element class for "'.concat(e,'". Must be a constructor.'))}}])}();return o(M,"ZkErrorElement",b),o(M,"ZkLabelElement",y),o(M,"ZkElement",g),o(M,"ZkFileElement",E),o(M,"ZkRadioElement",O),o(M,"ZkCheckboxElement",w),o(M,"ZkSelectElement",k),o(M,"ZkItemgroupElement",j),o(M,"ZkGroupElement",B),o(M,"ZkMultipleElement",A),o(M,"ZkMultipleActionElement",T),o(M,"ZkTabElement",x),o(M,"ZkButtons",C),o(M,"ZkAction",F),t.default})()));